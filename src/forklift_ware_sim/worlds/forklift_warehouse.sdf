<?xml version='1.0' encoding='ASCII'?>
<sdf version='1.7'>
  <world name='forklift_warehouse'>
    <gravity>0 0 -9.8</gravity>
    <physics type='ode'>
      <max_step_size>0.01</max_step_size>
      <real_time_factor>1</real_time_factor>
      <max_contacts>10</max_contacts>
    </physics>

    <!-- Required system plugins -->
    <plugin name='gz::sim::systems::Physics'   filename='gz-sim-physics-system'/>
    <plugin name='gz::sim::systems::UserCommands' filename='gz-sim-user-commands-system'/>
    <plugin name='gz::sim::systems::SceneBroadcaster' filename='gz-sim-scene-broadcaster-system'/>

    <!-- GUI layout -->
    <gui fullscreen="0">
      <plugin filename="GzScene3D" name="3D View">
        <ignition-gui>
          <title>3D View</title>
          <property type="bool" key="showTitleBar">false</property>
          <property type="string" key="state">docked</property>
        </ignition-gui>
        <engine>ogre2</engine>
        <scene>scene</scene>
        <ambient_light>0.6 0.6 0.6</ambient_light>
        <background_color>0.5 0.7 0.9</background_color>
        <!-- Camera looking at the forklift which is at x=0 y=0 z=0.25 -->
        <camera_pose>3 -5 2 0 0.3 2.2</camera_pose>
      </plugin>
      <plugin filename="WorldControl" name="World control">
        <ignition-gui>
          <property type="bool" key="showTitleBar">false</property>
          <property type="bool" key="resizable">false</property>
          <property type="double" key="height">72</property>
          <property type="double" key="width">121</property>
          <property type="double" key="z">1</property>
          <property type="string" key="state">floating</property>
          <anchors target="3D View">
            <line own="left"   target="left"/>
            <line own="bottom" target="bottom"/>
          </anchors>
        </ignition-gui>
        <play_pause>true</play_pause>
        <step>true</step>
        <start_paused>false</start_paused>
      </plugin>
      <plugin filename="WorldStats" name="World stats">
        <ignition-gui>
          <property type="bool" key="showTitleBar">false</property>
          <property type="bool" key="resizable">false</property>
          <property type="double" key="height">110</property>
          <property type="double" key="width">290</property>
          <property type="double" key="z">1</property>
          <property type="string" key="state">floating</property>
          <anchors target="3D View">
            <line own="right"  target="right"/>
            <line own="bottom" target="bottom"/>
          </anchors>
        </ignition-gui>
        <sim_time>true</sim_time>
        <real_time>true</real_time>
        <real_time_factor>true</real_time_factor>
        <iterations>true</iterations>
      </plugin>
      <plugin filename="EntityTree" name="Entity tree">
        <ignition-gui>
          <property key="state" type="string">docked_collapsed</property>
        </ignition-gui>
      </plugin>
    </gui>

    <!-- Scene lighting -->
    <scene>
      <ambient>0.8 0.8 0.8 1</ambient>
      <background>0.3 0.5 0.8 1</background>
      <shadows>0</shadows>
    </scene>
    <light type="directional" name="sun">
      <cast_shadows>0</cast_shadows>
      <pose>0 0 20 0 0 0</pose>
      <diffuse>1 1 1 1</diffuse>
      <specular>0.5 0.5 0.5 1</specular>
      <direction>0.1 0.1 -1</direction>
    </light>

    <!-- =================== GROUND PLANE =================== -->
    <model name='ground_plane'>
      <static>true</static>
      <link name='link'>
        <collision name='collision'>
          <geometry><plane><normal>0 0 1</normal><size>100 100</size></plane></geometry>
          <surface><friction><ode><mu>1</mu><mu2>1</mu2></ode></friction></surface>
        </collision>
        <visual name='visual'>
          <geometry><plane><normal>0 0 1</normal><size>100 100</size></plane></geometry>
          <material>
            <ambient>0.4 0.4 0.4 1</ambient>
            <diffuse>0.6 0.6 0.6 1</diffuse>
          </material>
        </visual>
      </link>
    </model>

    <!-- =================== WAREHOUSE WALLS (local boxes – no internet) =================== -->
    <!-- Floor slab (slightly above ground so forklift doesn't clip) -->
    <model name='warehouse_floor'>
      <static>true</static>
      <pose>0 0 -0.05 0 0 0</pose>
      <link name='link'>
        <collision name='c'><geometry><box><size>40 40 0.1</size></box></geometry></collision>
        <visual name='v'>
          <geometry><box><size>40 40 0.1</size></box></geometry>
          <material><ambient>0.45 0.42 0.38 1</ambient><diffuse>0.6 0.56 0.5 1</diffuse></material>
        </visual>
      </link>
    </model>

    <!-- North wall -->
    <model name='wall_north'>
      <static>true</static>
      <pose>0 20 3 0 0 0</pose>
      <link name='link'>
        <collision name='c'><geometry><box><size>40 0.3 6</size></box></geometry></collision>
        <visual name='v'>
          <geometry><box><size>40 0.3 6</size></box></geometry>
          <material><ambient>0.7 0.7 0.7 1</ambient><diffuse>0.85 0.85 0.85 1</diffuse></material>
        </visual>
      </link>
    </model>
    <!-- South wall -->
    <model name='wall_south'>
      <static>true</static>
      <pose>0 -20 3 0 0 0</pose>
      <link name='link'>
        <collision name='c'><geometry><box><size>40 0.3 6</size></box></geometry></collision>
        <visual name='v'>
          <geometry><box><size>40 0.3 6</size></box></geometry>
          <material><ambient>0.7 0.7 0.7 1</ambient><diffuse>0.85 0.85 0.85 1</diffuse></material>
        </visual>
      </link>
    </model>
    <!-- East wall -->
    <model name='wall_east'>
      <static>true</static>
      <pose>20 0 3 0 0 0</pose>
      <link name='link'>
        <collision name='c'><geometry><box><size>0.3 40 6</size></box></geometry></collision>
        <visual name='v'>
          <geometry><box><size>0.3 40 6</size></box></geometry>
          <material><ambient>0.7 0.7 0.7 1</ambient><diffuse>0.85 0.85 0.85 1</diffuse></material>
        </visual>
      </link>
    </model>
    <!-- West wall -->
    <model name='wall_west'>
      <static>true</static>
      <pose>-20 0 3 0 0 0</pose>
      <link name='link'>
        <collision name='c'><geometry><box><size>0.3 40 6</size></box></geometry></collision>
        <visual name='v'>
          <geometry><box><size>0.3 40 6</size></box></geometry>
          <material><ambient>0.7 0.7 0.7 1</ambient><diffuse>0.85 0.85 0.85 1</diffuse></material>
        </visual>
      </link>
    </model>

    <!-- Simple shelf rows using orange boxes -->
    <model name='shelf_row_1'>
      <static>true</static>
      <pose>-8 8 1.0 0 0 0</pose>
      <link name='link'>
        <collision name='c'><geometry><box><size>1.0 8.0 2.0</size></box></geometry></collision>
        <visual name='v'>
          <geometry><box><size>1.0 8.0 2.0</size></box></geometry>
          <material><ambient>0.7 0.4 0.1 1</ambient><diffuse>0.9 0.5 0.1 1</diffuse></material>
        </visual>
      </link>
    </model>
    <model name='shelf_row_2'>
      <static>true</static>
      <pose>8 8 1.0 0 0 0</pose>
      <link name='link'>
        <collision name='c'><geometry><box><size>1.0 8.0 2.0</size></box></geometry></collision>
        <visual name='v'>
          <geometry><box><size>1.0 8.0 2.0</size></box></geometry>
          <material><ambient>0.7 0.4 0.1 1</ambient><diffuse>0.9 0.5 0.1 1</diffuse></material>
        </visual>
      </link>
    </model>

    <!-- Target pallet box (blue) – forklift will pick this up -->
    <model name='target_pallet'>
      <static>false</static>
      <pose>0 6 0.3 0 0 0</pose>
      <link name='link'>
        <inertial><mass>50</mass>
          <inertia><ixx>1</ixx><ixy>0</ixy><ixz>0</ixz><iyy>1</iyy><iyz>0</iyz><izz>1</izz></inertia>
        </inertial>
        <collision name='c'><geometry><box><size>1.0 1.2 0.6</size></box></geometry>
          <surface><friction><ode><mu>0.8</mu><mu2>0.8</mu2></ode></friction></surface>
        </collision>
        <visual name='v'>
          <geometry><box><size>1.0 1.2 0.6</size></box></geometry>
          <material><ambient>0.1 0.3 0.8 1</ambient><diffuse>0.2 0.4 1.0 1</diffuse></material>
        </visual>
      </link>
    </model>

    <!-- =================== FORKLIFT (inlined, no model:// URI) =================== -->
    <!--
      Spawned at origin facing +Y (into the warehouse).
      Camera is positioned to the front-right so the forklift is immediately visible.
    -->
    <model name='forklift'>
      <pose>0 0 0.25 0 0 1.5708</pose>
      <static>0</static>

      <!-- ForkLiftPlugin: lift/shift/drive/odom via ROS 2 topics -->
      <plugin name="forklift_gazebo::ForkLiftPlugin" filename="libForkLiftPlugin.so"/>

      <!-- ── Main chassis ── -->
      <link name='fixed_box'>
        <pose>-0.02 0.0 0.0 0 0 0</pose>
        <inertial>
          <mass>50</mass>
          <inertia>
            <ixx>0.5417</ixx><ixy>0</ixy><ixz>0</ixz>
            <iyy>0.5417</iyy><iyz>0</iyz><izz>0.3333</izz>
          </inertia>
        </inertial>
        <visual name='visual'>
          <geometry><box><size>0.4 0.3 0.4</size></box></geometry>
          <material>
            <ambient>0.8 0.5 0.0 1</ambient>
            <diffuse>1.0 0.65 0.0 1</diffuse>
          </material>
        </visual>
        <collision name='collision'>
          <geometry><box><size>0.4 0.3 0.4</size></box></geometry>
        </collision>
      </link>

      <!-- ── Wheels ── -->
      <link name="wheel_front_left">
        <pose>0.15 0.18 -0.15 -1.5707963 0 0</pose>
        <inertial><mass>2</mass>
          <inertia><ixx>0.000354</ixx><ixy>0</ixy><ixz>0</ixz>
            <iyy>0.000354</iyy><iyz>0</iyz><izz>0.00025</izz></inertia>
        </inertial>
        <collision name="c">
          <geometry><cylinder><radius>0.07</radius><length>0.06</length></cylinder></geometry>
          <surface><friction><ode><mu>1.0</mu><mu2>1.0</mu2></ode></friction></surface>
        </collision>
        <visual name="v">
          <geometry><cylinder><radius>0.07</radius><length>0.06</length></cylinder></geometry>
          <material><ambient>0.1 0.1 0.1 1</ambient><diffuse>0.2 0.2 0.2 1</diffuse></material>
        </visual>
      </link>
      <joint name="wheel_front_left_joint" type="revolute">
        <parent>fixed_box</parent><child>wheel_front_left</child>
        <axis><xyz>0 0 1</xyz><limit><lower>-1e308</lower><upper>1e308</upper></limit></axis>
      </joint>

      <link name="wheel_front_right">
        <pose>0.15 -0.18 -0.15 -1.5707963 0 0</pose>
        <inertial><mass>2</mass>
          <inertia><ixx>0.000354</ixx><ixy>0</ixy><ixz>0</ixz>
            <iyy>0.000354</iyy><iyz>0</iyz><izz>0.00025</izz></inertia>
        </inertial>
        <collision name="c">
          <geometry><cylinder><radius>0.07</radius><length>0.06</length></cylinder></geometry>
          <surface><friction><ode><mu>1.0</mu><mu2>1.0</mu2></ode></friction></surface>
        </collision>
        <visual name="v">
          <geometry><cylinder><radius>0.07</radius><length>0.06</length></cylinder></geometry>
          <material><ambient>0.1 0.1 0.1 1</ambient><diffuse>0.2 0.2 0.2 1</diffuse></material>
        </visual>
      </link>
      <joint name="wheel_front_right_joint" type="revolute">
        <parent>fixed_box</parent><child>wheel_front_right</child>
        <axis><xyz>0 0 1</xyz><limit><lower>-1e308</lower><upper>1e308</upper></limit></axis>
      </joint>

      <link name="wheel_rear_left">
        <pose>-0.15 0.18 -0.15 -1.5707963 0 0</pose>
        <inertial><mass>2</mass>
          <inertia><ixx>0.000354</ixx><ixy>0</ixy><ixz>0</ixz>
            <iyy>0.000354</iyy><iyz>0</iyz><izz>0.00025</izz></inertia>
        </inertial>
        <collision name="c">
          <geometry><cylinder><radius>0.07</radius><length>0.06</length></cylinder></geometry>
          <surface><friction><ode><mu>0.5</mu><mu2>0.5</mu2></ode></friction></surface>
        </collision>
        <visual name="v">
          <geometry><cylinder><radius>0.07</radius><length>0.06</length></cylinder></geometry>
          <material><ambient>0.1 0.1 0.1 1</ambient><diffuse>0.2 0.2 0.2 1</diffuse></material>
        </visual>
      </link>
      <joint name="wheel_rear_left_joint" type="revolute">
        <parent>fixed_box</parent><child>wheel_rear_left</child>
        <axis><xyz>0 0 1</xyz><limit><lower>-1e308</lower><upper>1e308</upper></limit></axis>
      </joint>

      <link name="wheel_rear_right">
        <pose>-0.15 -0.18 -0.15 -1.5707963 0 0</pose>
        <inertial><mass>2</mass>
          <inertia><ixx>0.000354</ixx><ixy>0</ixy><ixz>0</ixz>
            <iyy>0.000354</iyy><iyz>0</iyz><izz>0.00025</izz></inertia>
        </inertial>
        <collision name="c">
          <geometry><cylinder><radius>0.07</radius><length>0.06</length></cylinder></geometry>
          <surface><friction><ode><mu>0.5</mu><mu2>0.5</mu2></ode></friction></surface>
        </collision>
        <visual name="v">
          <geometry><cylinder><radius>0.07</radius><length>0.06</length></cylinder></geometry>
          <material><ambient>0.1 0.1 0.1 1</ambient><diffuse>0.2 0.2 0.2 1</diffuse></material>
        </visual>
      </link>
      <joint name="wheel_rear_right_joint" type="revolute">
        <parent>fixed_box</parent><child>wheel_rear_right</child>
        <axis><xyz>0 0 1</xyz><limit><lower>-1e308</lower><upper>1e308</upper></limit></axis>
      </joint>

      <!-- ── Mast / fork carriage (base_fork) ── -->
      <model name='base_fork'>
        <link name='base_fork_link'>
          <pose>0.22 0 -0.05 0 0 0</pose>
          <inertial><mass>15</mass>
            <inertia><ixx>0.166667</ixx><ixy>0</ixy><ixz>0</ixz>
              <iyy>0.166667</iyy><iyz>0</iyz><izz>0.166667</izz></inertia>
          </inertial>
          <visual name='visual'>
            <geometry><box><size>0.08 0.25 0.4</size></box></geometry>
            <material><ambient>0.6 0.6 0.6 1</ambient><diffuse>0.75 0.75 0.75 1</diffuse></material>
          </visual>
          <collision name='collision'>
            <geometry><box><size>0.08 0.25 0.4</size></box></geometry>
            <surface>
              <contact><ode><max_vel>0.01</max_vel><min_depth>0.002</min_depth></ode></contact>
              <friction><ode><mu>0.8</mu><mu2>0.8</mu2></ode></friction>
            </surface>
          </collision>
        </link>
      </model>

      <!-- ── Fork tines ── -->
      <model name='fork'>
        <link name='fork_link'>
          <pose>0.42 0 -0.18 0 0 0</pose>
          <inertial><mass>8</mass>
            <inertia><ixx>0.166667</ixx><ixy>0</ixy><ixz>0</ixz>
              <iyy>0.166667</iyy><iyz>0</iyz><izz>0.166667</izz></inertia>
          </inertial>
          <visual name='visual'>
            <geometry><box><size>0.45 0.2 0.04</size></box></geometry>
            <material><ambient>0.5 0.5 0.1 1</ambient><diffuse>0.8 0.8 0.1 1</diffuse></material>
          </visual>
          <collision name='collision'>
            <geometry><box><size>0.45 0.2 0.04</size></box></geometry>
            <surface>
              <contact><ode><max_vel>0.01</max_vel><min_depth>0.003</min_depth></ode></contact>
              <friction><ode><mu>0.6</mu><mu2>0.6</mu2></ode></friction>
            </surface>
          </collision>
        </link>
      </model>

      <!-- lift: moves fork up/down -->
      <joint name='lift' type='prismatic'>
        <parent>base_fork::base_fork_link</parent>
        <child>fork::fork_link</child>
        <axis>
          <xyz>0 0 1</xyz>
          <limit><lower>0</lower><upper>0.35</upper><effort>500</effort><velocity>0.1</velocity></limit>
          <dynamics><damping>5.0</damping><friction>2.0</friction></dynamics>
        </axis>
      </joint>

      <!-- shift: moves fork carriage left/right -->
      <joint name='shift' type='prismatic'>
        <parent>fixed_box</parent>
        <child>base_fork::base_fork_link</child>
        <axis>
          <xyz>0 1 0</xyz>
          <limit><lower>-0.12</lower><upper>0.12</upper>
                 <effort>1000000</effort><velocity>1000000</velocity></limit>
        </axis>
      </joint>

      <allow_auto_disable>1</allow_auto_disable>
    </model>

  </world>
</sdf>
